# File path to save the JSON data
$jsonFilePath = #path where file should be stored

# Collect system information
$systemInfo = @{
    OSVersion = (Get-WmiObject -Class Win32_OperatingSystem).Version
    ComputerName = (Get-WmiObject -Class Win32_ComputerSystem).Name
    InstalledSoftware = Get-WmiObject -Class Win32_Product | Select-Object Name, Version
    NetworkAdapters = Get-WmiObject -Class Win32_NetworkAdapterConfiguration | Where-Object { $_.IPEnabled -eq $true } | Select-Object Description, MACAddress, IPAddress
}

# Collect ARP table (handling the ARP table output properly)
$arpTable = arp -a | ForEach-Object {
    if ($_ -match '^\s*([^ ]+)\s+([^ ]+)\s+([^ ]+)\s*$') {
        [PSCustomObject]@{
            IPAddress = $matches[1]
            MACAddress = $matches[2]
            Type = $matches[3]
        }
    }
}
$systemInfo["ARPTable"] = $arpTable

# Convert the data to JSON and save it to a file
try {
    $jsonContent = $systemInfo | ConvertTo-Json -Depth 5
    $jsonContent | Out-File -FilePath $jsonFilePath -Encoding utf8
    Write-Output "System and network data saved to $jsonFilePath"
} catch {
    Write-Error "Failed to save JSON data: $_"
}

# Output collected data to console for verification
Write-Output "Collected System and Network Data:"
$systemInfo | Format-List
